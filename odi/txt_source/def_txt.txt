"insert /*+ APPEND */ into EBH_LD_BPI.BPI_FE_BEA_TRAN_HISTORY 
( 
    EFFECTIVE_LOAD_DATE, 
    ID, 
    USERNAME, 
    SERVICENAME, 
    SERVICEID, 
    ORGUNITID, 
    STORAGEID, 
    TXDATETIME, 
    CURRENCY, 
    CLIENTID, 
    CLIENTNAME, 
    BRANCHID, 
    NARRATION, 
    ROLE, 
    STATCODE, 
    AMOUNTIN, 
    AMOUNTOUT, 
    DAMAGEDAMOUNTIN, 
    DAMAGEDAMOUNTOUT, 
    BO_CORRECTION, 
    PO_SAP_CODE, 
    PO_OFFICE_CODE, 
    PO_ONLINE, 
    EXTERNALID, 
    DENOM_STORNO, 
    HUF_AMOUNTOUT, 
    HUF_AMOUNTIN, 
    CLIENT_WHO_PAID, 
    IS_EBH_CLIENT, 
    LOAD_ID 
) select 
    TO_DATE(:GLOBAL.P_EFFECTIVE_LOAD_DATE,'YYYYMMDDHH24MISS') EFFECTIVE_LOAD_DATE, 
    F_TRAHIS_A.ID ID, 
    F_TRAHIS_A.USERNAME USERNAME, 
    F_TRAHIS_A.SERVICENAME SERVICENAME, 
    F_TRAHIS_A.SERVICEID SERVICEID, 
    F_TRAHIS_A.ORGUNITID ORGUNITID, 
    F_TRAHIS_A.STORAGEID STORAGEID, 
    F_TRAHIS_A.TXDATETIME TXDATETIME, 
    F_TRAHIS_A.CURRENCY CURRENCY, 
    F_TRAHIS_A.CLIENTID CLIENTID, 
    F_TRAHIS_A.CLIENTNAME CLIENTNAME, 
    F_TRAHIS_A.BRANCHID BRANCHID, 
    F_TRAHIS_A.NARRATION NARRATION, 
    F_TRAHIS_A.ROLE ROLE, 
    F_TRAHIS_A.STATCODE STATCODE, 
    F_TRAHIS_A.AMOUNTIN AMOUNTIN, 
    F_TRAHIS_A.AMOUNTOUT AMOUNTOUT, 
    F_TRAHIS_A.DAMAGEDAMOUNTIN DAMAGEDAMOUNTIN, 
    F_TRAHIS_A.DAMAGEDAMOUNTOUT DAMAGEDAMOUNTOUT, 
    F_TRAHIS_A.BO_CORRECTION BO_CORRECTION, 
    F_TRAHIS_A.PO_SAP_CODE PO_SAP_CODE, 
    F_TRAHIS_A.PO_OFFICE_CODE PO_OFFICE_CODE, 
    F_TRAHIS_A.PO_ONLINE PO_ONLINE, 
    F_TRAHIS_A.EXTERNALID EXTERNALID, 
    F_TRAHIS_A.DENOM_STORNO DENOM_STORNO, 
    F_TRAHIS_A.HUF_AMOUNTOUT HUF_AMOUNTOUT, 
    F_TRAHIS_A.HUF_AMOUNTIN HUF_AMOUNTIN, 
    F_TRAHIS_A.CLIENT_WHO_PAID CLIENT_WHO_PAID, 
    F_TRAHIS_A.IS_EBH_CLIENT IS_EBH_CLIENT, 
    :GLOBAL.P_LOAD_ID LOAD_ID 
from 
(select 
    ATRAN_HISTORY.ID ID, 
    ATRAN_HISTORY.USERNAME USERNAME, 
    ATRAN_HISTORY.SERVICENAME SERVICENAME, 
    ATRAN_HISTORY.SERVICEID SERVICEID, 
    ATRAN_HISTORY.ORGUNITID ORGUNITID, 
    ATRAN_HISTORY.STORAGEID STORAGEID, 
    ATRAN_HISTORY.TXDATETIME TXDATETIME, 
    ATRAN_HISTORY.CURRENCY CURRENCY, 
    ATRAN_HISTORY.CLIENTID CLIENTID, 
    ATRAN_HISTORY.CLIENTNAME CLIENTNAME, 
    ATRAN_HISTORY.BRANCHID BRANCHID, 
    ATRAN_HISTORY.NARRATION NARRATION, 
    ATRAN_HISTORY.ROLE ROLE, 
    ATRAN_HISTORY.STATCODE STATCODE, 
    ATRAN_HISTORY.AMOUNTIN AMOUNTIN, 
    ATRAN_HISTORY.AMOUNTOUT AMOUNTOUT, 
    ATRAN_HISTORY.DAMAGEDAMOUNTIN DAMAGEDAMOUNTIN, 
    ATRAN_HISTORY.DAMAGEDAMOUNTOUT DAMAGEDAMOUNTOUT, 
    ATRAN_HISTORY.BO_CORRECTION BO_CORRECTION, 
    ATRAN_HISTORY.PO_SAP_CODE PO_SAP_CODE, 
    ATRAN_HISTORY.PO_OFFICE_CODE PO_OFFICE_CODE, 
    ATRAN_HISTORY.PO_ONLINE PO_ONLINE, 
    ATRAN_HISTORY.EXTERNALID EXTERNALID, 
    ATRAN_HISTORY.DENOM_STORNO DENOM_STORNO, 
    ATRAN_HISTORY.HUF_AMOUNTOUT HUF_AMOUNTOUT, 
    ATRAN_HISTORY.HUF_AMOUNTIN HUF_AMOUNTIN, 
    ATRAN_HISTORY.CLIENT_WHO_PAID CLIENT_WHO_PAID, 
    ATRAN_HISTORY.IS_EBH_CLIENT IS_EBH_CLIENT 
from 
FE_BEA_TRAN_HISTORY@MID_EBH_META ATRAN_HISTORY 
where 
 (ATRAN_HISTORY.TXDATETIME <= TO_DATE(:GLOBAL.P_EFFECTIVE_LOAD_DATE,'YYYYMMDDHH24MISS')) 
) F_TRAHIS_A  INNER JOIN  (
SELECT 
  nvl(MAX(BPI_FE_BEA_TRAN_HISTORY_MAX.TXDATETIME),date'1900-01-01') AS MAX_TXDATETIME   
FROM 
  EBH_LD_BPI.BPI_FE_BEA_TRAN_HISTORY BPI_FE_BEA_TRAN_HISTORY_MAX   
  ) BPI_FE_BEA_TRAN_HISTORY_MAX_1  
    ON  F_TRAHIS_A.TXDATETIME > BPI_FE_BEA_TRAN_HISTORY_MAX_1.MAX_TXDATETIME
  "